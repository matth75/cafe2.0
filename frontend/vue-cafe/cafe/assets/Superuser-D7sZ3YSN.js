import{d as w,r as u,c as n,o as A,j as L,b as d,e as a,f as x,t as C,k as m,l as i,w as v,m as B,i as _,_ as U}from"./index-B6v4qw03.js";const j={class:"content"},N={key:0,class:"status-message"},V={style:{"text-align":"center"}},E=w({__name:"Superuser",setup(F){const o=u([]),l=u(!1),r=u(null),y=u("teachers"),c=e=>{if(typeof e=="boolean")return e;if(typeof e=="number")return e!==0;if(typeof e=="string"){const t=e.trim().toLowerCase();return t==="true"||t==="1"||t==="oui"}return!1},p=e=>{const t=e.superuser??e.is_superuser??e.isSuperuser;return c(t)},f=e=>{const t=String(e.droit??e.role??e.right??"").toLowerCase();if(t.includes("prof")||t.includes("enseignant")||t.includes("teacher"))return!0;const s=e.teacher??e.is_teacher??e.isTeacher;return c(s)},g=n(()=>o.value.filter(e=>f(e))),k=n(()=>o.value.filter(e=>p(e))),b=n(()=>o.value.filter(e=>!f(e)&&!p(e))),h=n(()=>[{key:"teachers",title:"Professeurs",users:g.value,emptyLabel:"Aucun professeur trouvé."},{key:"students",title:"Élèves",users:b.value,emptyLabel:"Aucun élève trouvé."},{key:"superusers",title:"Superusers",users:k.value,emptyLabel:"Aucun superuser trouvé."}]);n(()=>h.value.filter(e=>e.key===y.value)),A(async()=>{l.value=!0,r.value=null;const e=typeof window<"u"?window.localStorage.getItem("cafe_token"):null;if(!e){r.value="Authentification requise pour accéder à la liste des utilisateurs.",l.value=!1;return}try{const t=await L(e);o.value=S(t)}catch(t){console.error("Failed to fetch users list",t),r.value="Impossible de récupérer la liste des utilisateurs."}finally{l.value=!1}});function S(e){return e?Array.isArray(e)?e:typeof e=="object"?Object.entries(e).map(([t,s])=>({login:t,...s??{}})):[]:[]}return(e,t)=>{const s=B("RouterLink");return _(),d("section",j,[t[3]||(t[3]=a("header",{class:"major"},[a("h1",null,"Espace Superuser"),a("p",null,"Actions réservées aux administrateurs de la plateforme CAFE.")],-1)),r.value?(_(),d("p",N,C(r.value),1)):x("",!0),a("div",V,[m(s,{class:"button Button_principal",to:"/su_people"},{default:v(()=>[...t[0]||(t[0]=[i("Gérer les utilisateurs",-1)])]),_:1}),t[2]||(t[2]=i("       ",-1)),m(s,{class:"button Button_principal",to:"/su_cal"},{default:v(()=>[...t[1]||(t[1]=[i("Gérer les calendriers",-1)])]),_:1})])])}}}),T=U(E,[["__scopeId","data-v-2a8aeafe"]]);export{T as default};
